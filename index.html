<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Correspond√™ncias</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .content {
            padding: 30px;
        }

        .form-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 4px solid #3498db;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e8ed;
            border-radius: 6px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #27ae60, #229954);
        }

        .btn-success:hover {
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .btn-danger:hover {
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
        }

        .correspondencia-card {
            background: white;
            border: 1px solid #e1e8ed;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .correspondencia-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-pendente {
            background: #fff3cd;
            color: #856404;
        }

        .status-entregue {
            background: #d4edda;
            color: #155724;
        }

        .entrega-section {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
            border-left: 4px solid #27ae60;
            display: none;
        }

        .entrega-section.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; max-height: 0; }
            to { opacity: 1; max-height: 200px; }
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 6px;
            font-weight: 500;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s ease;
        }

        .alert.show {
            opacity: 1;
            transform: translateY(0);
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 4px solid #3498db;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #7f8c8d;
            font-weight: 500;
        }

        .search-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .search-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e8ed;
            border-radius: 6px;
            font-size: 16px;
        }

        .no-data {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
            font-style: italic;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
            }
            
            .content {
                padding: 20px;
            }
            
            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üì¨ Sistema de Correspond√™ncias</h1>
            <p>Gerencie suas correspond√™ncias de forma eficiente</p>
        </div>

        <div class="content">
            <div id="alertContainer"></div>

            <!-- Estat√≠sticas -->
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number" id="totalCorrespondencias">0</div>
                    <div class="stat-label">Total</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="pendentes">0</div>
                    <div class="stat-label">Pendentes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="entregues">0</div>
                    <div class="stat-label">Entregues</div>
                </div>
            </div>

            <!-- Formul√°rio de Cadastro -->
            <div class="form-section">
                <h2>üìù Nova Correspond√™ncia</h2>
                <form id="correspondenciaForm">
                    <div class="grid">
                        <div class="form-group">
                            <label for="destinatario">Destinat√°rio *</label>
                            <input type="text" id="destinatario" name="destinatario" required>
                        </div>
                        <div class="form-group">
                            <label for="remetente">Remetente</label>
                            <input type="text" id="remetente" name="remetente">
                        </div>
                        <div class="form-group">
                            <label for="tipo">Tipo de Correspond√™ncia *</label>
                            <select id="tipo" name="tipo" required>
                                <option value="">Selecione o tipo</option>
                                <option value="carta">Carta</option>
                                <option value="encomenda">Encomenda</option>
                                <option value="sedex">Sedex</option>
                                <option value="ar">AR (Aviso de Recebimento)</option>
                                <option value="telegrama">Telegrama</option>
                                <option value="outros">Outros</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="dataRecebimento">Data de Recebimento *</label>
                            <input type="date" id="dataRecebimento" name="dataRecebimento" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="observacoes">Observa√ß√µes</label>
                        <textarea id="observacoes" name="observacoes" rows="3" placeholder="Informa√ß√µes adicionais sobre a correspond√™ncia"></textarea>
                    </div>
                    <button type="submit" class="btn">üíæ Cadastrar Correspond√™ncia</button>
                    <button type="button" class="btn btn-danger" onclick="limparFormulario()">üóëÔ∏è Limpar</button>
                </form>
            </div>

            <!-- Busca -->
            <div class="search-section">
                <h3>üîç Buscar Correspond√™ncias</h3>
                <input type="text" class="search-input" id="searchInput" placeholder="Digite o nome do destinat√°rio, remetente ou tipo...">
            </div>

            <!-- Lista de Correspond√™ncias -->
            <div class="form-section">
                <h2>üìã Correspond√™ncias Cadastradas</h2>
                <div id="listaCorrespondencias">
                    <div class="no-data">
                        Nenhuma correspond√™ncia cadastrada ainda.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sistema de persist√™ncia usando um objeto para simular banco de dados
        class CorrespondenciasDB {
            constructor() {
                this.dados = this.carregarDados();
                this.proximoId = this.obterProximoId();
            }

            carregarDados() {
                // Simula carregamento de dados - aqui voc√™ faria uma chamada para sua API
                const dadosSalvos = JSON.parse(localStorage.getItem('correspondencias') || '[]');
                return dadosSalvos;
            }

            salvarDados() {
                // Simula salvamento de dados - aqui voc√™ faria uma chamada para sua API
                localStorage.setItem('correspondencias', JSON.stringify(this.dados));
            }

            obterProximoId() {
                const ids = this.dados.map(item => item.id || 0);
                return Math.max(...ids, 0) + 1;
            }

            adicionar(correspondencia) {
                const nova = {
                    ...correspondencia,
                    id: this.proximoId++,
                    status: 'pendente',
                    dataCadastro: new Date().toISOString()
                };
                this.dados.push(nova);
                this.salvarDados();
                return nova;
            }

            obterTodos() {
                return [...this.dados];
            }

            atualizar(id, dados) {
                const index = this.dados.findIndex(item => item.id === id);
                if (index !== -1) {
                    this.dados[index] = { ...this.dados[index], ...dados };
                    this.salvarDados();
                    return this.dados[index];
                }
                return null;
            }

            remover(id) {
                const index = this.dados.findIndex(item => item.id === id);
                if (index !== -1) {
                    const removido = this.dados.splice(index, 1)[0];
                    this.salvarDados();
                    return removido;
                }
                return null;
            }
        }

        // Inst√¢ncia do banco de dados
        const db = new CorrespondenciasDB();

        // Elementos do DOM
        const form = document.getElementById('correspondenciaForm');
        const listaCorrespondencias = document.getElementById('listaCorrespondencias');
        const searchInput = document.getElementById('searchInput');
        const alertContainer = document.getElementById('alertContainer');

        // Event Listeners
        form.addEventListener('submit', handleSubmit);
        searchInput.addEventListener('input', filtrarCorrespondencias);

        // Definir data atual como padr√£o
        document.getElementById('dataRecebimento').value = new Date().toISOString().split('T')[0];

        function handleSubmit(e) {
            e.preventDefault();
            
            const formData = new FormData(form);
            const correspondencia = {
                destinatario: formData.get('destinatario'),
                remetente: formData.get('remetente'),
                tipo: formData.get('tipo'),
                dataRecebimento: formData.get('dataRecebimento'),
                observacoes: formData.get('observacoes')
            };

            try {
                db.adicionar(correspondencia);
                mostrarAlerta('Correspond√™ncia cadastrada com sucesso!', 'success');
                form.reset();
                document.getElementById('dataRecebimento').value = new Date().toISOString().split('T')[0];
                renderizarCorrespondencias();
                atualizarEstatisticas();
            } catch (error) {
                mostrarAlerta('Erro ao cadastrar correspond√™ncia. Tente novamente.', 'error');
                console.error('Erro:', error);
            }
        }

        function renderizarCorrespondencias(correspondencias = null) {
            const dados = correspondencias || db.obterTodos();
            
            if (dados.length === 0) {
                listaCorrespondencias.innerHTML = '<div class="no-data">Nenhuma correspond√™ncia encontrada.</div>';
                return;
            }

            const html = dados.map(corresp => `
                <div class="correspondencia-card">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">
                        <div>
                            <h3 style="color: #2c3e50; margin-bottom: 5px;">üìß ${corresp.destinatario}</h3>
                            <span class="status-badge status-${corresp.status}">${corresp.status}</span>
                        </div>
                        <div style="text-align: right; font-size: 14px; color: #7f8c8d;">
                            ID: #${corresp.id}
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <p><strong>Remetente:</strong> ${corresp.remetente || 'N√£o informado'}</p>
                        <p><strong>Tipo:</strong> ${corresp.tipo}</p>
                        <p><strong>Data de Recebimento:</strong> ${formatarData(corresp.dataRecebimento)}</p>
                        ${corresp.observacoes ? `<p><strong>Observa√ß√µes:</strong> ${corresp.observacoes}</p>` : ''}
                    </div>

                    ${corresp.status === 'entregue' ? `
                        <div class="entrega-section show">
                            <h4 style="color: #27ae60; margin-bottom: 10px;">‚úÖ Informa√ß√µes da Entrega</h4>
                            <p><strong>Entregue para:</strong> ${corresp.entregueAra}</p>
                            <p><strong>Data da Entrega:</strong> ${formatarData(corresp.dataEntrega)}</p>
                            <p><strong>Hora da Entrega:</strong> ${corresp.horaEntrega}</p>
                        </div>
                    ` : ''}

                    <div style="margin-top: 15px;">
                        ${corresp.status === 'pendente' ? `
                            <button class="btn btn-success" onclick="marcarComoEntregue(${corresp.id})">
                                ‚úÖ Marcar como Entregue
                            </button>
                        ` : ''}
                        <button class="btn btn-danger" onclick="removerCorrespondencia(${corresp.id})">
                            üóëÔ∏è Excluir
                        </button>
                    </div>
                </div>
            `).join('');

            listaCorrespondencias.innerHTML = html;
        }

        function marcarComoEntregue(id) {
            const pessoa = prompt('Para quem foi entregue a correspond√™ncia?');
            if (pessoa && pessoa.trim()) {
                const agora = new Date();
                const dados = {
                    status: 'entregue',
                    entregueAra: pessoa.trim(),
                    dataEntrega: agora.toISOString().split('T')[0],
                    horaEntrega: agora.toTimeString().split(' ')[0].substring(0, 5)
                };

                db.atualizar(id, dados);
                mostrarAlerta('Correspond√™ncia marcada como entregue!', 'success');
                renderizarCorrespondencias();
                atualizarEstatisticas();
            }
        }

        function removerCorrespondencia(id) {
            if (confirm('Tem certeza que deseja excluir esta correspond√™ncia?')) {
                db.remover(id);
                mostrarAlerta('Correspond√™ncia exclu√≠da com sucesso!', 'success');
                renderizarCorrespondencias();
                atualizarEstatisticas();
            }
        }

        function filtrarCorrespondencias() {
            const termo = searchInput.value.toLowerCase();
            const correspondencias = db.obterTodos().filter(corresp => 
                corresp.destinatario.toLowerCase().includes(termo) ||
                (corresp.remetente && corresp.remetente.toLowerCase().includes(termo)) ||
                corresp.tipo.toLowerCase().includes(termo)
            );
            renderizarCorrespondencias(correspondencias);
        }

        function atualizarEstatisticas() {
            const dados = db.obterTodos();
            const total = dados.length;
            const pendentes = dados.filter(c => c.status === 'pendente').length;
            const entregues = dados.filter(c => c.status === 'entregue').length;

            document.getElementById('totalCorrespondencias').textContent = total;
            document.getElementById('pendentes').textContent = pendentes;
            document.getElementById('entregues').textContent = entregues;
        }

        function formatarData(data) {
            return new Date(data + 'T00:00:00').toLocaleDateString('pt-BR');
        }

        function limparFormulario() {
            form.reset();
            document.getElementById('dataRecebimento').value = new Date().toISOString().split('T')[0];
        }

        function mostrarAlerta(mensagem, tipo) {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${tipo === 'success' ? 'success' : 'danger'}`;
            alertDiv.textContent = mensagem;
            
            alertContainer.appendChild(alertDiv);
            
            setTimeout(() => {
                alertDiv.classList.add('show');
            }, 10);

            setTimeout(() => {
                alertDiv.classList.remove('show');
                setTimeout(() => {
                    alertContainer.removeChild(alertDiv);
                }, 300);
            }, 3000);
        }

        // Inicializar a p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            renderizarCorrespondencias();
            atualizarEstatisticas();
        });

        // Interceptar o refresh da p√°gina para salvar dados
        window.addEventListener('beforeunload', function() {
            // Os dados j√° s√£o salvos automaticamente no localStorage
            // mas voc√™ pode fazer uma chamada para sua API aqui se necess√°rio
        });
    </script>
</body>
</html>
